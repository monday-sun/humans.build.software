---
import DefaultLayout from '../layouts/DefaultLayout.astro'
import Hero from '../components/Hero.astro'
import { getCollection } from 'astro:content'

// Get recent blog posts
const allBlogPosts = await getCollection('blog', ({ data }) => {
  return !data.draft
})

const recentPosts = allBlogPosts
  .sort((a, b) => new Date(b.data.pubDate).valueOf() - new Date(a.data.pubDate).valueOf())
  .slice(0, 4)
---

<DefaultLayout title="Home">
  <Hero />

  <section class="my-24">
    <div class="container">
      <h2 class="mb-16 text-4xl">What to Expect</h2>
      <div class="prose prose-lg dark:prose-invert mx-auto">
        <p>
          This blog is a collection of honest reflections on modern software development. Expect discussions about
          building resilient systems, navigating team dynamics, integrating AI tools thoughtfully, and recovering
          gracefully from inevitable mistakes.
        </p>
        <p>No polished corporate blog posts hereâ€”just genuine insights from the trenches of software development.</p>
      </div>
    </div>
  </section>

  <section class="my-24">
    <div class="container">
      <h2 class="mb-16 text-4xl">Recent Posts</h2>
      <div class="grid grid-cols-1 gap-8 md:grid-cols-2">
        {
          recentPosts.map((post) => (
            <div class="card">
              <div class="card-body">
                <h3 class="text-2xl font-medium">
                  <a href={`/blog/${post.id}`} class="hover:text-primary-600 dark:hover:text-primary-400">
                    {post.data.title}
                  </a>
                </h3>
                <p class="mt-2 text-sm text-gray-600 dark:text-gray-400">
                  {new Date(post.data.pubDate).toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                  })}
                </p>
                <p class="mt-4">{post.data.description}</p>
                <div class="mt-6">
                  <a href={`/blog/${post.id}`} class="link-button">
                    Read more
                  </a>
                </div>
              </div>
            </div>
          ))
        }
      </div>
      <div class="mt-12 text-center">
        <a href="/blog" class="button has-icon"> View all posts </a>
      </div>
    </div>
  </section>
</DefaultLayout>

<style>
  .card {
    transition:
      transform 0.2s ease-in-out,
      box-shadow 0.2s ease-in-out;
    box-shadow:
      0 4px 6px -1px rgba(0, 0, 0, 0.1),
      0 2px 4px -2px rgba(0, 0, 0, 0.1);
    border-radius: 0.5rem;
    background-color: var(--neutral-100);
    overflow: hidden;
  }

  .card:hover {
    transform: translateY(-4px);
    box-shadow:
      0 10px 15px -3px rgba(0, 0, 0, 0.1),
      0 4px 6px -4px rgba(0, 0, 0, 0.1);
  }

  .card-body {
    padding: 1.5rem;
  }

  .link-button {
    display: inline-flex;
    align-items: center;
    transition: color 0.2s ease-in-out;
    color: var(--primary-500);
    font-weight: 500;
    text-decoration: none;
  }

  .link-button:hover {
    color: var(--primary-700);
    text-decoration: underline;
  }

  :global(.darkmode) .card {
    background-color: var(--neutral-900);
  }
</style>
